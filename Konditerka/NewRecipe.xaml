<mah:MetroWindow x:Class="Konditerka.NewRecipe"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Konditerka"
        mc:Ignorable="d"
        xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls" 
        Title="NewRecipe" Height="Auto" Width="800">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <Grid>

            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <Border Grid.Row="0" BorderBrush="#CCC" BorderThickness="1" 
                    CornerRadius="5" Padding="10" Margin="5" Background="#F9F9F9" 
                    HorizontalAlignment="Stretch" MaxWidth="780" VerticalAlignment="Center">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="0.25*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0" Text="Название: " VerticalAlignment="Center" Margin="5" FontSize="14" />
                    <TextBox Grid.Column="1" Name="NameCake" FontSize="14" mah:TextBoxHelper.Watermark="Вводите название шедевра" VerticalAlignment="Center" Margin="5" />
                
                    <TextBlock Grid.Column="2" Text="Категория: " VerticalAlignment="Center" Margin="5" FontSize="14" />
                    <ComboBox Grid.Column="3" x:Name="Category" IsEditable="True" IsReadOnly="True" FontSize="14" 
                              mah:TextBoxHelper.Watermark="Выберите категорию" VerticalAlignment="Center" Margin="5" >
                        <ComboBoxItem Content="Торт"/>
                        <ComboBoxItem Content="Эклер"/>
                        <ComboBoxItem Content="Пирожное"/>
                        <ComboBoxItem Content="Капкейк"/>
                    </ComboBox>
                
                    <TextBlock Grid.Column="4" Text="Время приготовления: " VerticalAlignment="Center" Margin="5" FontSize="14" />
                    <TextBox Grid.Column="5" Name="Time" FontSize="14" mah:TextBoxHelper.Watermark="1.5 " VerticalAlignment="Center" Margin="5" />
                    <TextBlock Grid.Column="6" Text="часа" VerticalAlignment="Center" Margin="0" FontSize="14" />
                </Grid>
            </Border>
        
            <Border Grid.Row="1" BorderBrush="#CCC" BorderThickness="1" 
            CornerRadius="5" Padding="10" Margin="5" Background="#F9F9F9" 
            HorizontalAlignment="Stretch" MaxWidth="780" VerticalAlignment="Center">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <TextBox Name="Opisanie" FontSize="14" mah:TextBoxHelper.Watermark="Кратко опишите данное произведение..." VerticalAlignment="Center" Margin="5,0,5,0" TextWrapping="Wrap"/>
                    <TextBox Grid.Column="1" Name="Instruct" FontSize="14" mah:TextBoxHelper.Watermark="Опишите этапы приготовления" VerticalAlignment="Center" Margin="5,0,5,0" TextWrapping="Wrap"/>
                </Grid>
            </Border>

            <Border Grid.Row="2" BorderBrush="#FF252733" BorderThickness="2" CornerRadius="2" Margin="5" Background="#FFF5CFCF" 
    VerticalAlignment="Center" HorizontalAlignment="Center" Height="Auto" Width="Auto">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="Общий вес торта согласно рецепту: " Margin="5" FontSize="16" />
                    <TextBox x:Name="VesTB" Grid.Column="1" FontSize="16" Width="40" mah:TextBoxHelper.Watermark="2.8" TextAlignment="Center"/>
                    <TextBlock Grid.Column="2" Text="кг" FontSize="16" Margin="5"/>
                </Grid>
            </Border>

            <Border Grid.Row="3" BorderBrush="#CCC" BorderThickness="2" 
    CornerRadius="2" Margin="125,0,125,0" Background="#F9F9F9" 
    HorizontalAlignment="Stretch" MaxWidth="780" VerticalAlignment="Center" >

                <TextBlock Text="Заполните состав рецепта и количество необходимых ингредиентов" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="5" FontSize="16" />
            </Border>

            <GroupBox Grid.Row="4" Header="Ингредиенты" Margin="10" MaxWidth="780">
                <StackPanel>
                    <!-- Список ингредиентов -->
                    <ItemsControl Name="IngredientsList">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Grid Margin="0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBox Name="TBoxIngr" Margin="5,0" FontSize="14" mah:TextBoxHelper.Watermark="Ингредиент" 
                                     Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" TextChanged="TBoxIngr_TextChanged" />
                                    <ListBox Grid.Row="2" Name="List" Margin="5"  SelectionChanged="List_SelectionChanged" 
                                             FontSize="14" Cursor="Hand" Background="Azure"/>

                                    <TextBox Grid.Column="1" Margin="5,0" FontSize="14" mah:TextBoxHelper.Watermark="Количество" 
                                     Text="{Binding Kolich, UpdateSourceTrigger=PropertyChanged}"/>

                                    <TextBox Name="EdIzm" Grid.Column="2" Margin="5,0" FontSize="14" mah:TextBoxHelper.Watermark="Ед. изм." IsReadOnly="True"
                                     Text="{Binding EdIzm, UpdateSourceTrigger=PropertyChanged}"/>

                                    <!-- Кнопка удаления строки (опционально) -->
                                    <Button Grid.Column="3" Content="✕" Background="Transparent" BorderThickness="0" Foreground="Red" Click="RemoveIngredient_Click" Tag="{Binding}"/>
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <!-- Кнопка добавления -->
                    <Button Content="+ Добавить ингредиент" 
                    HorizontalAlignment="Left" 
                    Margin="5,10,5,0" 
                    Click="AddIngredient_Click" 
                    Style="{StaticResource MahApps.Styles.Button.Flat}"/>
                </StackPanel>
            </GroupBox>

            <DataGrid Name="DG" Visibility="Collapsed"/>

            <!-- Кнопка добавления фото, без функционала -->
            <Border Visibility="Collapsed" Grid.Row="4" BorderBrush="#CCC" BorderThickness="1" 
    CornerRadius="5" Padding="10" Margin="10" Background="#F9F9F9" 
    HorizontalAlignment="Stretch" MaxWidth="780" VerticalAlignment="Center">
                <StackPanel>
                    <Button Content="Добавить фото" HorizontalAlignment="Left" Margin="5,10,5,0"/>
                    <Image x:Name="photo" Width="150" Height="150" Margin="5" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </StackPanel>
            </Border>

            <Button Grid.Row="5" x:Name="Save" Content="Добавить" Width="246" Height="27" Margin="0,5,0,10" 
                    HorizontalAlignment="Center" VerticalAlignment="Top" Background="Pink" Foreground="Gray" FontSize="11" Click="Save_Click"/>
        </Grid>
    </ScrollViewer>
</mah:MetroWindow>
